{"ast":null,"code":"import _createForOfIteratorHelper from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _classCallCheck from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport { fromType } from '../Nodes.js';\nimport { Loader } from 'three';\nvar NodeLoader = /*#__PURE__*/function (_Loader) {\n  _inherits(NodeLoader, _Loader);\n  var _super = _createSuper(NodeLoader);\n  function NodeLoader(manager) {\n    var _this;\n    _classCallCheck(this, NodeLoader);\n    _this = _super.call(this, manager);\n    _this.textures = {};\n    return _this;\n  }\n  _createClass(NodeLoader, [{\n    key: \"load\",\n    value: function load(url, onLoad, onProgress, onError) {\n      var _this2 = this;\n      var loader = new FileLoader(this.manager);\n      loader.setPath(this.path);\n      loader.setRequestHeader(this.requestHeader);\n      loader.setWithCredentials(this.withCredentials);\n      loader.load(url, function (text) {\n        try {\n          onLoad(_this2.parse(JSON.parse(text)));\n        } catch (e) {\n          if (onError) {\n            onError(e);\n          } else {\n            console.error(e);\n          }\n          _this2.manager.itemError(url);\n        }\n      }, onProgress, onError);\n    }\n  }, {\n    key: \"parseNodes\",\n    value: function parseNodes(json) {\n      var nodes = {};\n      if (json !== undefined) {\n        var _iterator = _createForOfIteratorHelper(json),\n          _step;\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var nodeJSON = _step.value;\n            var uuid = nodeJSON.uuid,\n              _type = nodeJSON.type;\n            nodes[uuid] = fromType(_type);\n            nodes[uuid].uuid = uuid;\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n        var meta = {\n          nodes: nodes,\n          textures: this.textures\n        };\n        var _iterator2 = _createForOfIteratorHelper(json),\n          _step2;\n        try {\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var _nodeJSON = _step2.value;\n            _nodeJSON.meta = meta;\n            var node = nodes[_nodeJSON.uuid];\n            node.deserialize(_nodeJSON);\n            delete _nodeJSON.meta;\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n      }\n      return nodes;\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(json) {\n      var node = fromType(type);\n      node.uuid = json.uuid;\n      var nodes = this.parseNodes(json.inputNodes);\n      var meta = {\n        nodes: nodes,\n        textures: this.textures\n      };\n      json.meta = meta;\n      node.deserialize(json);\n      delete json.meta;\n      return node;\n    }\n  }, {\n    key: \"setTextures\",\n    value: function setTextures(value) {\n      this.textures = value;\n      return this;\n    }\n  }]);\n  return NodeLoader;\n}(Loader);\nexport default NodeLoader;","map":{"version":3,"names":["fromType","Loader","NodeLoader","_Loader","_inherits","_super","_createSuper","manager","_this","_classCallCheck","call","textures","_createClass","key","value","load","url","onLoad","onProgress","onError","_this2","loader","FileLoader","setPath","path","setRequestHeader","requestHeader","setWithCredentials","withCredentials","text","parse","JSON","e","console","error","itemError","parseNodes","json","nodes","undefined","_iterator","_createForOfIteratorHelper","_step","s","n","done","nodeJSON","uuid","type","err","f","meta","_iterator2","_step2","node","deserialize","inputNodes","setTextures"],"sources":["/home/samuel/experiment/3d/farm/frontend/node_modules/three-stdlib/nodes/loaders/NodeLoader.js"],"sourcesContent":["import { fromType } from '../Nodes.js';\nimport { Loader } from 'three';\n\nclass NodeLoader extends Loader {\n  constructor(manager) {\n    super(manager);\n    this.textures = {};\n  }\n\n  load(url, onLoad, onProgress, onError) {\n    const loader = new FileLoader(this.manager);\n    loader.setPath(this.path);\n    loader.setRequestHeader(this.requestHeader);\n    loader.setWithCredentials(this.withCredentials);\n    loader.load(url, text => {\n      try {\n        onLoad(this.parse(JSON.parse(text)));\n      } catch (e) {\n        if (onError) {\n          onError(e);\n        } else {\n          console.error(e);\n        }\n\n        this.manager.itemError(url);\n      }\n    }, onProgress, onError);\n  }\n\n  parseNodes(json) {\n    const nodes = {};\n\n    if (json !== undefined) {\n      for (const nodeJSON of json) {\n        const {\n          uuid,\n          type\n        } = nodeJSON;\n        nodes[uuid] = fromType(type);\n        nodes[uuid].uuid = uuid;\n      }\n\n      const meta = {\n        nodes,\n        textures: this.textures\n      };\n\n      for (const nodeJSON of json) {\n        nodeJSON.meta = meta;\n        const node = nodes[nodeJSON.uuid];\n        node.deserialize(nodeJSON);\n        delete nodeJSON.meta;\n      }\n    }\n\n    return nodes;\n  }\n\n  parse(json) {\n    const node = fromType(type);\n    node.uuid = json.uuid;\n    const nodes = this.parseNodes(json.inputNodes);\n    const meta = {\n      nodes,\n      textures: this.textures\n    };\n    json.meta = meta;\n    node.deserialize(json);\n    delete json.meta;\n    return node;\n  }\n\n  setTextures(value) {\n    this.textures = value;\n    return this;\n  }\n\n}\n\nexport default NodeLoader;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}