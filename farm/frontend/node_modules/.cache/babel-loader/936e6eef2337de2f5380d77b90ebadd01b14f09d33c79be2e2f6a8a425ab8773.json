{"ast":null,"code":"import _slicedToArray from\"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState}from'react';import{Rufus,Gunter}from'./chicken';import{Fire}from'./effect';import useKeyboard from'./useKeyboard';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Chickens=function Chickens(props){var players=props.players;return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Rufus,{players:players})});};var Wall=function Wall(props){var x=props.x,h=props.h,z=props.z;return/*#__PURE__*/_jsx(\"rect\",{x:x,y:z,width:1,height:1,fill:h?'green':' black'});};var Player=function Player(props){var position=props.position,material=props.material;return/*#__PURE__*/_jsx(\"rect\",{x:position.x+.1,y:position.z+.1,width:\".8\",height:\".8\",fill:material.color});};var moveTo=function moveTo(data,code,p){var tryPosition=function tryPosition(old,p){return data[p.z][p.x]?old:p;};switch(code){case'ArrowUp':return tryPosition(p,{x:p.x,z:p.z-1});case'ArrowDown':return tryPosition(p,{x:p.x,z:p.z+1});case'ArrowLeft':return tryPosition(p,{x:p.x-1,z:p.z});case'ArrowRight':return tryPosition(p,{x:p.x+1,z:p.z});default:return p;}};var Walls=function Walls(props){var data=props.data;return/*#__PURE__*/_jsx(_Fragment,{children:data.map(function(row,r){return row.map(function(w,c){return/*#__PURE__*/_jsx(Wall,{x:c,h:w,z:r});});})});};var Maze=function Maze(props){var data=props.data,style=props.style,player=props.player;var _useState=useState(player.position),_useState2=_slicedToArray(_useState,2),position=_useState2[0],setPosition=_useState2[1];var _useState3=useState({from:null,to:null}),_useState4=_slicedToArray(_useState3,2),fire=_useState4[0],setFire=_useState4[1];var width=data[0].length;var height=data.length;var scale={x:style.width/width,y:style.height/height};var handleFire=function handleFire(from,to){setFire({from:from,to:to});};useKeyboard({onPressing:function onPressing(code){return setPosition(function(p){return moveTo(data,code,p);});}});return/*#__PURE__*/_jsx(\"svg\",{style:style,children:/*#__PURE__*/_jsxs(\"g\",{transform:\"scale(\".concat(scale.x,\",\").concat(scale.y,\")\"),children:[/*#__PURE__*/_jsx(Walls,{data:data}),/*#__PURE__*/_jsx(Player,{position:position,material:player.material}),/*#__PURE__*/_jsx(Chickens,{players:[position],onFire:handleFire}),/*#__PURE__*/_jsx(Fire,{from:fire.from,to:fire.to})]})});};export default Maze;","map":{"version":3,"names":["useState","Rufus","Gunter","Fire","useKeyboard","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Chickens","props","players","children","Wall","x","h","z","y","width","height","fill","Player","position","material","color","moveTo","data","code","p","tryPosition","old","Walls","map","row","r","w","c","Maze","style","player","_useState","_useState2","_slicedToArray","setPosition","_useState3","from","to","_useState4","fire","setFire","length","scale","handleFire","onPressing","transform","concat","onFire"],"sources":["/home/samuel/experiment/3d/farm/frontend/src/view/maze.js"],"sourcesContent":["import {useState} from 'react'\nimport {Rufus, Gunter} from './chicken'\nimport {Fire} from './effect'\nimport useKeyboard from './useKeyboard'\n\nconst Chickens = props => {\n\tlet {players} = props\n\treturn <>\n\t\t\t<Rufus players={players} />\n\t\t\t{/*<Gunter players={players} />*/}\n\t\t</>\n}\n\nconst Wall = props => {\n\t\tlet {x,h,z} = props\n\n\treturn <rect\n\t\t\tx={x}\n\t\t\ty={z}\n\t\t\twidth={1}\n\t\t\theight={1}\n\t\t\tfill={h ? 'green' : ' black'} \n\t\t/>\n}\n\nconst Player = props => {\n\t\tlet {position, material} = props\n\n\treturn\t<rect\n\t\t\tx={position.x + .1}\n\t\t\ty={position.z + .1}\n\t\t\twidth='.8'\n\t\t\theight='.8'\n\t\t\tfill={material.color} \n\t\t/>\n}\n\nlet moveTo = (data, code, p) => {\n\tlet tryPosition = (old, p) => data[p.z][p.x] ? old : p\n\n\tswitch(code){\n\t\tcase 'ArrowUp' : return tryPosition(p, {x: p.x, z: p.z - 1})\n\t\tcase 'ArrowDown' : return tryPosition(p, {x: p.x, z: p.z + 1})\n\t\tcase 'ArrowLeft' : return tryPosition(p, {x: p.x - 1, z: p.z})\n\t\tcase 'ArrowRight' : return tryPosition(p, {x: p.x + 1, z: p.z})\n\t\tdefault : return p\n\t}\n}\n\nconst Walls = props => {\n\tlet {data} = props\n\treturn <>\n\t\t\t{data.map( (row, r) => row.map((w,c) => <Wall x={c} h={w} z={r} /> ))}\n\t\t</>\n}\n\nlet Maze = props => {\n\tlet {data, style, player} = props\n\n\tlet [position, setPosition] = useState(player.position)\n\tlet [fire, setFire] = useState({from: null, to: null})\n\n\tlet width = data[0].length\n\tlet height = data.length\n\n\tlet scale = {\n\t\tx : style.width/width,\n\t\ty: style.height/height\n\t}\n\n\tlet handleFire = (from, to) => {\n\t\tsetFire({from, to})\n\t}\n\n\tuseKeyboard({\n\t\tonPressing : code  => setPosition(p => moveTo(data, code, p))\n\t})\n\n\treturn <svg style={style} >\n\t\t\t<g transform={`scale(${scale.x},${scale.y})`}>\n\n\t\t\t\t<Walls data={data} />\n\n\t\t\t\t<Player position={position} material={player.material} />\n\n\t\t\t\t<Chickens players={[position]} onFire={handleFire} />\n\n\t\t\t\t<Fire from={fire.from} to={fire.to} />\n\t\t\t</g>\n\t\t</svg>\n}\n\nexport default Maze\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}