{"ast":null,"code":"import _createForOfIteratorHelper from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _classCallCheck from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _get from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport CodeNode from './CodeNode.js';\nimport FunctionCallNode from './FunctionCallNode.js';\nvar FunctionNode = /*#__PURE__*/function (_CodeNode) {\n  _inherits(FunctionNode, _CodeNode);\n  var _super = _createSuper(FunctionNode);\n  function FunctionNode() {\n    var _this;\n    var code = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    _classCallCheck(this, FunctionNode);\n    _this = _super.call(this, code);\n    _this.keywords = {};\n    return _this;\n  }\n  _createClass(FunctionNode, [{\n    key: \"getNodeType\",\n    value: function getNodeType(builder) {\n      return this.getNodeFunction(builder).type;\n    }\n  }, {\n    key: \"getInputs\",\n    value: function getInputs(builder) {\n      return this.getNodeFunction(builder).inputs;\n    }\n  }, {\n    key: \"getNodeFunction\",\n    value: function getNodeFunction(builder) {\n      var nodeData = builder.getDataFromNode(this);\n      var nodeFunction = nodeData.nodeFunction;\n      if (nodeFunction === undefined) {\n        nodeFunction = builder.parser.parseFunction(this.code);\n        nodeData.nodeFunction = nodeFunction;\n      }\n      return nodeFunction;\n    }\n  }, {\n    key: \"call\",\n    value: function call() {\n      var parameters = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return new FunctionCallNode(this, parameters);\n    }\n  }, {\n    key: \"generate\",\n    value: function generate(builder, output) {\n      _get(_getPrototypeOf(FunctionNode.prototype), \"generate\", this).call(this, builder);\n      var nodeFunction = this.getNodeFunction(builder);\n      var name = nodeFunction.name;\n      var type = nodeFunction.type;\n      var nodeCode = builder.getCodeFromNode(this, type);\n      if (name !== '') {\n        // use a custom property name\n        nodeCode.name = name;\n      }\n      var propertyName = builder.getPropertyName(nodeCode);\n      var code = this.getNodeFunction(builder).getCode(propertyName);\n      var keywords = this.keywords;\n      var keywordsProperties = Object.keys(keywords);\n      if (keywordsProperties.length > 0) {\n        var _iterator = _createForOfIteratorHelper(keywordsProperties),\n          _step;\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var property = _step.value;\n            var propertyRegExp = new RegExp(\"\\\\b\".concat(property, \"\\\\b\"), 'g');\n            var nodeProperty = keywords[property].build(builder, 'property');\n            code = code.replace(propertyRegExp, nodeProperty);\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      }\n      nodeCode.code = code;\n      if (output === 'property') {\n        return propertyName;\n      } else {\n        return builder.format(\"\".concat(propertyName, \"()\"), type, output);\n      }\n    }\n  }]);\n  return FunctionNode;\n}(CodeNode);\nexport default FunctionNode;","map":{"version":3,"names":["CodeNode","FunctionCallNode","FunctionNode","_CodeNode","_inherits","_super","_createSuper","_this","code","arguments","length","undefined","_classCallCheck","call","keywords","_createClass","key","value","getNodeType","builder","getNodeFunction","type","getInputs","inputs","nodeData","getDataFromNode","nodeFunction","parser","parseFunction","parameters","generate","output","_get","_getPrototypeOf","prototype","name","nodeCode","getCodeFromNode","propertyName","getPropertyName","getCode","keywordsProperties","Object","keys","_iterator","_createForOfIteratorHelper","_step","s","n","done","property","propertyRegExp","RegExp","concat","nodeProperty","build","replace","err","e","f","format"],"sources":["/home/samuel/experiment/3d/farm/frontend/node_modules/three-stdlib/nodes/core/FunctionNode.js"],"sourcesContent":["import CodeNode from './CodeNode.js';\nimport FunctionCallNode from './FunctionCallNode.js';\n\nclass FunctionNode extends CodeNode {\n  constructor(code = '') {\n    super(code);\n    this.keywords = {};\n  }\n\n  getNodeType(builder) {\n    return this.getNodeFunction(builder).type;\n  }\n\n  getInputs(builder) {\n    return this.getNodeFunction(builder).inputs;\n  }\n\n  getNodeFunction(builder) {\n    const nodeData = builder.getDataFromNode(this);\n    let nodeFunction = nodeData.nodeFunction;\n\n    if (nodeFunction === undefined) {\n      nodeFunction = builder.parser.parseFunction(this.code);\n      nodeData.nodeFunction = nodeFunction;\n    }\n\n    return nodeFunction;\n  }\n\n  call(parameters = {}) {\n    return new FunctionCallNode(this, parameters);\n  }\n\n  generate(builder, output) {\n    super.generate(builder);\n    const nodeFunction = this.getNodeFunction(builder);\n    const name = nodeFunction.name;\n    const type = nodeFunction.type;\n    const nodeCode = builder.getCodeFromNode(this, type);\n\n    if (name !== '') {\n      // use a custom property name\n      nodeCode.name = name;\n    }\n\n    const propertyName = builder.getPropertyName(nodeCode);\n    let code = this.getNodeFunction(builder).getCode(propertyName);\n    const keywords = this.keywords;\n    const keywordsProperties = Object.keys(keywords);\n\n    if (keywordsProperties.length > 0) {\n      for (const property of keywordsProperties) {\n        const propertyRegExp = new RegExp(`\\\\b${property}\\\\b`, 'g');\n        const nodeProperty = keywords[property].build(builder, 'property');\n        code = code.replace(propertyRegExp, nodeProperty);\n      }\n    }\n\n    nodeCode.code = code;\n\n    if (output === 'property') {\n      return propertyName;\n    } else {\n      return builder.format(`${propertyName}()`, type, output);\n    }\n  }\n\n}\n\nexport default FunctionNode;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}