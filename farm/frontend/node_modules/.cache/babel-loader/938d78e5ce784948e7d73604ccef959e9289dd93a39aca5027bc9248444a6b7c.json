{"ast":null,"code":"import _createClass from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _classCallCheck from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _assertThisInitialized from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _defineProperty from '@babel/runtime/helpers/esm/defineProperty';\nimport { EventDispatcher, Vector3, Euler, Quaternion, MathUtils } from 'three';\n\n/**\n * W3C Device Orientation control (http://w3c.github.io/deviceorientation/spec-source-orientation.html)\n */\nvar DeviceOrientationControls = /*#__PURE__*/function (_EventDispatcher) {\n  _inherits(DeviceOrientationControls, _EventDispatcher);\n  var _super = _createSuper(DeviceOrientationControls);\n  // radians\n  function DeviceOrientationControls(object) {\n    var _this;\n    _classCallCheck(this, DeviceOrientationControls);\n    _this = _super.call(this);\n    _defineProperty(_assertThisInitialized(_this), \"object\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"changeEvent\", {\n      type: 'change'\n    });\n    _defineProperty(_assertThisInitialized(_this), \"EPS\", 0.000001);\n    _defineProperty(_assertThisInitialized(_this), \"enabled\", true);\n    _defineProperty(_assertThisInitialized(_this), \"deviceOrientation\", {\n      alpha: 0,\n      beta: 0,\n      gamma: 0\n    });\n    _defineProperty(_assertThisInitialized(_this), \"screenOrientation\", 0);\n    _defineProperty(_assertThisInitialized(_this), \"alphaOffset\", 0);\n    _defineProperty(_assertThisInitialized(_this), \"onDeviceOrientationChangeEvent\", function (event) {\n      _this.deviceOrientation = event;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onScreenOrientationChangeEvent\", function () {\n      _this.screenOrientation = window.orientation || 0;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"zee\", new Vector3(0, 0, 1));\n    _defineProperty(_assertThisInitialized(_this), \"euler\", new Euler());\n    _defineProperty(_assertThisInitialized(_this), \"q0\", new Quaternion());\n    _defineProperty(_assertThisInitialized(_this), \"q1\", new Quaternion(-Math.sqrt(0.5), 0, 0, Math.sqrt(0.5)));\n    _defineProperty(_assertThisInitialized(_this), \"setObjectQuaternion\", function (quaternion, alpha, beta, gamma, orient) {\n      _this.euler.set(beta, alpha, -gamma, 'YXZ'); // 'ZXY' for the device, but 'YXZ' for us\n\n      quaternion.setFromEuler(_this.euler); // orient the device\n\n      quaternion.multiply(_this.q1); // camera looks out the back of the device, not the top\n\n      quaternion.multiply(_this.q0.setFromAxisAngle(_this.zee, -orient)); // adjust for screen orientation\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"connect\", function () {\n      _this.onScreenOrientationChangeEvent(); // run once on load\n      // iOS 13+\n\n      if (window.DeviceOrientationEvent !== undefined && typeof window.DeviceOrientationEvent.requestPermission === 'function') {\n        window.DeviceOrientationEvent.requestPermission().then(function (response) {\n          if (response == 'granted') {\n            window.addEventListener('orientationchange', _this.onScreenOrientationChangeEvent);\n            window.addEventListener('deviceorientation', _this.onDeviceOrientationChangeEvent);\n          }\n        }).catch(function (error) {\n          console.error('THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:', error);\n        });\n      } else {\n        window.addEventListener('orientationchange', _this.onScreenOrientationChangeEvent);\n        window.addEventListener('deviceorientation', _this.onDeviceOrientationChangeEvent);\n      }\n      _this.enabled = true;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"disconnect\", function () {\n      window.removeEventListener('orientationchange', _this.onScreenOrientationChangeEvent);\n      window.removeEventListener('deviceorientation', _this.onDeviceOrientationChangeEvent);\n      _this.enabled = false;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"lastQuaternion\", new Quaternion());\n    _defineProperty(_assertThisInitialized(_this), \"update\", function () {\n      if (_this.enabled === false) return;\n      var device = _this.deviceOrientation;\n      if (device) {\n        var alpha = device.alpha ? MathUtils.degToRad(device.alpha) + _this.alphaOffset : 0; // Z\n\n        var beta = device.beta ? MathUtils.degToRad(device.beta) : 0; // X'\n\n        var gamma = device.gamma ? MathUtils.degToRad(device.gamma) : 0; // Y''\n\n        var orient = _this.screenOrientation ? MathUtils.degToRad(_this.screenOrientation) : 0; // O\n\n        _this.setObjectQuaternion(_this.object.quaternion, alpha, beta, gamma, orient);\n        if (8 * (1 - _this.lastQuaternion.dot(_this.object.quaternion)) > _this.EPS) {\n          _this.lastQuaternion.copy(_this.object.quaternion);\n          _this.dispatchEvent(_this.changeEvent);\n        }\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"dispose\", function () {\n      return _this.disconnect();\n    });\n    _this.object = object;\n    _this.object.rotation.reorder('YXZ');\n    _this.connect();\n    return _this;\n  }\n  return _createClass(DeviceOrientationControls);\n}(EventDispatcher);\nexport { DeviceOrientationControls };","map":{"version":3,"names":["_defineProperty","EventDispatcher","Vector3","Euler","Quaternion","MathUtils","DeviceOrientationControls","_EventDispatcher","_inherits","_super","_createSuper","object","_this","_classCallCheck","call","_assertThisInitialized","type","alpha","beta","gamma","event","deviceOrientation","screenOrientation","window","orientation","Math","sqrt","quaternion","orient","euler","set","setFromEuler","multiply","q1","q0","setFromAxisAngle","zee","onScreenOrientationChangeEvent","DeviceOrientationEvent","undefined","requestPermission","then","response","addEventListener","onDeviceOrientationChangeEvent","catch","error","console","enabled","removeEventListener","device","degToRad","alphaOffset","setObjectQuaternion","lastQuaternion","dot","EPS","copy","dispatchEvent","changeEvent","disconnect","rotation","reorder","connect","_createClass"],"sources":["/home/samuel/experiment/3d/farm/frontend/node_modules/three-stdlib/controls/DeviceOrientationControls.js"],"sourcesContent":["import _defineProperty from '@babel/runtime/helpers/esm/defineProperty';\nimport { EventDispatcher, Vector3, Euler, Quaternion, MathUtils } from 'three';\n\n/**\n * W3C Device Orientation control (http://w3c.github.io/deviceorientation/spec-source-orientation.html)\n */\n\nclass DeviceOrientationControls extends EventDispatcher {\n  // radians\n  constructor(object) {\n    super();\n\n    _defineProperty(this, \"object\", void 0);\n\n    _defineProperty(this, \"changeEvent\", {\n      type: 'change'\n    });\n\n    _defineProperty(this, \"EPS\", 0.000001);\n\n    _defineProperty(this, \"enabled\", true);\n\n    _defineProperty(this, \"deviceOrientation\", {\n      alpha: 0,\n      beta: 0,\n      gamma: 0\n    });\n\n    _defineProperty(this, \"screenOrientation\", 0);\n\n    _defineProperty(this, \"alphaOffset\", 0);\n\n    _defineProperty(this, \"onDeviceOrientationChangeEvent\", event => {\n      this.deviceOrientation = event;\n    });\n\n    _defineProperty(this, \"onScreenOrientationChangeEvent\", () => {\n      this.screenOrientation = window.orientation || 0;\n    });\n\n    _defineProperty(this, \"zee\", new Vector3(0, 0, 1));\n\n    _defineProperty(this, \"euler\", new Euler());\n\n    _defineProperty(this, \"q0\", new Quaternion());\n\n    _defineProperty(this, \"q1\", new Quaternion(-Math.sqrt(0.5), 0, 0, Math.sqrt(0.5)));\n\n    _defineProperty(this, \"setObjectQuaternion\", (quaternion, alpha, beta, gamma, orient) => {\n      this.euler.set(beta, alpha, -gamma, 'YXZ'); // 'ZXY' for the device, but 'YXZ' for us\n\n      quaternion.setFromEuler(this.euler); // orient the device\n\n      quaternion.multiply(this.q1); // camera looks out the back of the device, not the top\n\n      quaternion.multiply(this.q0.setFromAxisAngle(this.zee, -orient)); // adjust for screen orientation\n    });\n\n    _defineProperty(this, \"connect\", () => {\n      this.onScreenOrientationChangeEvent(); // run once on load\n      // iOS 13+\n\n      if (window.DeviceOrientationEvent !== undefined && typeof window.DeviceOrientationEvent.requestPermission === 'function') {\n        window.DeviceOrientationEvent.requestPermission().then(response => {\n          if (response == 'granted') {\n            window.addEventListener('orientationchange', this.onScreenOrientationChangeEvent);\n            window.addEventListener('deviceorientation', this.onDeviceOrientationChangeEvent);\n          }\n        }).catch(error => {\n          console.error('THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:', error);\n        });\n      } else {\n        window.addEventListener('orientationchange', this.onScreenOrientationChangeEvent);\n        window.addEventListener('deviceorientation', this.onDeviceOrientationChangeEvent);\n      }\n\n      this.enabled = true;\n    });\n\n    _defineProperty(this, \"disconnect\", () => {\n      window.removeEventListener('orientationchange', this.onScreenOrientationChangeEvent);\n      window.removeEventListener('deviceorientation', this.onDeviceOrientationChangeEvent);\n      this.enabled = false;\n    });\n\n    _defineProperty(this, \"lastQuaternion\", new Quaternion());\n\n    _defineProperty(this, \"update\", () => {\n      if (this.enabled === false) return;\n      const device = this.deviceOrientation;\n\n      if (device) {\n        const alpha = device.alpha ? MathUtils.degToRad(device.alpha) + this.alphaOffset : 0; // Z\n\n        const beta = device.beta ? MathUtils.degToRad(device.beta) : 0; // X'\n\n        const gamma = device.gamma ? MathUtils.degToRad(device.gamma) : 0; // Y''\n\n        const orient = this.screenOrientation ? MathUtils.degToRad(this.screenOrientation) : 0; // O\n\n        this.setObjectQuaternion(this.object.quaternion, alpha, beta, gamma, orient);\n\n        if (8 * (1 - this.lastQuaternion.dot(this.object.quaternion)) > this.EPS) {\n          this.lastQuaternion.copy(this.object.quaternion);\n          this.dispatchEvent(this.changeEvent);\n        }\n      }\n    });\n\n    _defineProperty(this, \"dispose\", () => this.disconnect());\n\n    this.object = object;\n    this.object.rotation.reorder('YXZ');\n    this.connect();\n  }\n\n}\n\nexport { DeviceOrientationControls };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}