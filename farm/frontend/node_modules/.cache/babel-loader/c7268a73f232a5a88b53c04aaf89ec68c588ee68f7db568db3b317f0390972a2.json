{"ast":null,"code":"import _createForOfIteratorHelper from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _classCallCheck from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/home/samuel/experiment/3d/farm/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport Node from '../core/Node.js';\nimport LightNode from './LightNode.js';\nvar sortLights = function sortLights(lights) {\n  return lights.sort(function (a, b) {\n    return a.id - b.id;\n  });\n};\nvar LightsNode = /*#__PURE__*/function (_Node) {\n  _inherits(LightsNode, _Node);\n  var _super = _createSuper(LightsNode);\n  function LightsNode() {\n    var _this;\n    var lightNodes = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    _classCallCheck(this, LightsNode);\n    _this = _super.call(this, 'vec3');\n    _this.lightNodes = lightNodes;\n    _this._hash = null;\n    return _this;\n  }\n  _createClass(LightsNode, [{\n    key: \"hasLight\",\n    get: function get() {\n      return this.lightNodes.length > 0;\n    }\n  }, {\n    key: \"generate\",\n    value: function generate(builder) {\n      var lightNodes = this.lightNodes;\n      var _iterator = _createForOfIteratorHelper(lightNodes),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var lightNode = _step.value;\n          lightNode.build(builder);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      return 'vec3( 0.0 )';\n    }\n  }, {\n    key: \"getHash\",\n    value: function getHash() {\n      if (this._hash === null) {\n        var hash = '';\n        var lightNodes = this.lightNodes;\n        var _iterator2 = _createForOfIteratorHelper(lightNodes),\n          _step2;\n        try {\n          for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n            var lightNode = _step2.value;\n            hash += lightNode.light.uuid + ' ';\n          }\n        } catch (err) {\n          _iterator2.e(err);\n        } finally {\n          _iterator2.f();\n        }\n        this._hash = hash;\n      }\n      return this._hash;\n    }\n  }, {\n    key: \"getLightNodeByHash\",\n    value: function getLightNodeByHash(hash) {\n      var lightNodes = this.lightNodes;\n      var _iterator3 = _createForOfIteratorHelper(lightNodes),\n        _step3;\n      try {\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n          var lightNode = _step3.value;\n          if (lightNode.light.uuid === hash) {\n            return lightNode;\n          }\n        }\n      } catch (err) {\n        _iterator3.e(err);\n      } finally {\n        _iterator3.f();\n      }\n      return null;\n    }\n  }, {\n    key: \"fromLights\",\n    value: function fromLights(lights) {\n      var lightNodes = [];\n      lights = sortLights(lights);\n      var _iterator4 = _createForOfIteratorHelper(lights),\n        _step4;\n      try {\n        for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n          var light = _step4.value;\n          var lightNode = this.getLightNodeByHash(light.uuid);\n          if (lightNode === null) {\n            lightNode = new LightNode(light);\n          }\n          lightNodes.push(lightNode);\n        }\n      } catch (err) {\n        _iterator4.e(err);\n      } finally {\n        _iterator4.f();\n      }\n      this.lightNodes = lightNodes;\n      this._hash = null;\n      return this;\n    }\n  }]);\n  return LightsNode;\n}(Node);\nexport default LightsNode;","map":{"version":3,"names":["Node","LightNode","sortLights","lights","sort","a","b","id","LightsNode","_Node","_inherits","_super","_createSuper","_this","lightNodes","arguments","length","undefined","_classCallCheck","call","_hash","_createClass","key","get","value","generate","builder","_iterator","_createForOfIteratorHelper","_step","s","n","done","lightNode","build","err","e","f","getHash","hash","_iterator2","_step2","light","uuid","getLightNodeByHash","_iterator3","_step3","fromLights","_iterator4","_step4","push"],"sources":["/home/samuel/experiment/3d/farm/frontend/node_modules/three-stdlib/nodes/lights/LightsNode.js"],"sourcesContent":["import Node from '../core/Node.js';\nimport LightNode from './LightNode.js';\n\nconst sortLights = lights => {\n  return lights.sort((a, b) => a.id - b.id);\n};\n\nclass LightsNode extends Node {\n  constructor(lightNodes = []) {\n    super('vec3');\n    this.lightNodes = lightNodes;\n    this._hash = null;\n  }\n\n  get hasLight() {\n    return this.lightNodes.length > 0;\n  }\n\n  generate(builder) {\n    const lightNodes = this.lightNodes;\n\n    for (const lightNode of lightNodes) {\n      lightNode.build(builder);\n    }\n\n    return 'vec3( 0.0 )';\n  }\n\n  getHash() {\n    if (this._hash === null) {\n      let hash = '';\n      const lightNodes = this.lightNodes;\n\n      for (const lightNode of lightNodes) {\n        hash += lightNode.light.uuid + ' ';\n      }\n\n      this._hash = hash;\n    }\n\n    return this._hash;\n  }\n\n  getLightNodeByHash(hash) {\n    const lightNodes = this.lightNodes;\n\n    for (const lightNode of lightNodes) {\n      if (lightNode.light.uuid === hash) {\n        return lightNode;\n      }\n    }\n\n    return null;\n  }\n\n  fromLights(lights) {\n    const lightNodes = [];\n    lights = sortLights(lights);\n\n    for (const light of lights) {\n      let lightNode = this.getLightNodeByHash(light.uuid);\n\n      if (lightNode === null) {\n        lightNode = new LightNode(light);\n      }\n\n      lightNodes.push(lightNode);\n    }\n\n    this.lightNodes = lightNodes;\n    this._hash = null;\n    return this;\n  }\n\n}\n\nexport default LightsNode;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}