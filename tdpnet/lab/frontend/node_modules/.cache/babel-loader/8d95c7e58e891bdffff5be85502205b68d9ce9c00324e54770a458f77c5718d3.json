{"ast":null,"code":"import _toConsumableArray from\"/home/samuel/experiment/tdpnet/lab/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/samuel/experiment/tdpnet/lab/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"/home/samuel/experiment/tdpnet/lab/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState}from'react';import{Node,Link}from'./node';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var position=function position(w,h){return{x:Math.floor(Math.random()*w),y:Math.floor(Math.random()*h)};};var organizePositions=function organizePositions(nodes,size){return nodes.map(function(item){return _objectSpread(_objectSpread({},item),{},{pos:position(size.width-20,size.height-20)});});};var organizeLinks=function organizeLinks(positions,links){return links.map(function(link){var _positions$find,_positions$find2;return{a:(_positions$find=positions.find(function(item){return item.id===link.a;}))===null||_positions$find===void 0?void 0:_positions$find.pos,b:(_positions$find2=positions.find(function(item){return item.id===link.b;}))===null||_positions$find2===void 0?void 0:_positions$find2.pos};});};var Network=function Network(props){var style=props.style,data=props.data,size=props.size;var _useState=useState(size.width&&size.height?organizePositions(data.nodes,size):organizePositions(data.nodes,{width:400,height:400})),_useState2=_slicedToArray(_useState,2),positions=_useState2[0],setPositions=_useState2[1];var _useState3=useState(organizeLinks(positions,data.links)),_useState4=_slicedToArray(_useState3,2),links=_useState4[0],setLinks=_useState4[1];var handleClick=function handleClick(){//setPositions( organizePositions(data.nodes, size) )\n};var handleDragging=function handleDragging(id,pos){var node=positions.find(function(item){return item.id===id;});var newpositions=[].concat(_toConsumableArray(positions.filter(function(item){return item.id!==id;})),[_objectSpread(_objectSpread({},node),{},{pos:pos})]);setPositions(function(positions){return newpositions;});setLinks(organizeLinks(newpositions,data.links));};return/*#__PURE__*/_jsxs(\"svg\",{style:style,onClick:handleClick,children:[links.filter(function(item){return item.a&&item.b;}).map(function(item){return/*#__PURE__*/_jsx(Link,{a:item.a,b:item.b});}),positions.map(function(item){return size.width&&size.height&&/*#__PURE__*/_jsx(Node,{id:item.id,label:item.name,type:item.type,pos:item.pos,r:20,onDragging:handleDragging},item.id);})]});};export default Network;","map":{"version":3,"names":["useState","Node","Link","jsx","_jsx","jsxs","_jsxs","position","w","h","x","Math","floor","random","y","organizePositions","nodes","size","map","item","_objectSpread","pos","width","height","organizeLinks","positions","links","link","_positions$find","_positions$find2","a","find","id","b","Network","props","style","data","_useState","_useState2","_slicedToArray","setPositions","_useState3","_useState4","setLinks","handleClick","handleDragging","node","newpositions","concat","_toConsumableArray","filter","onClick","children","label","name","type","r","onDragging"],"sources":["/home/samuel/experiment/tdpnet/lab/frontend/src/view/network.js"],"sourcesContent":["import {useState} from 'react'\n\nimport {Node, Link} from './node'\n\nlet position = (w,h) => ({x : Math.floor(Math.random()*w), y: Math.floor(Math.random()*h)})\n\nlet organizePositions = (nodes, size) => nodes.map(item => ({...item, pos: position(size.width - 20, size.height - 20)}))\n\nlet organizeLinks = (positions, links) => {\n\treturn links.map(link => ({\n\t\ta: positions.find(item => item.id === link.a)?.pos,\n\t\tb: positions.find(item => item.id === link.b)?.pos\n\t})\n)}\n\nconst Network = props => {\n\tlet {style, data, size} = props\n\n\tlet [positions, setPositions] = useState(size.width && size.height ? organizePositions(data.nodes, size) : organizePositions(data.nodes, {width: 400, height: 400}))\n\tlet [links, setLinks] = useState(organizeLinks(positions, data.links))\n\n\tlet handleClick = () => {\n\t\t//setPositions( organizePositions(data.nodes, size) )\n\t}\n\n\tlet handleDragging = (id, pos) => {\n\t\tlet node = positions.find(item => item.id === id)\n\t\tlet newpositions = [...positions.filter(item => item.id !== id), {...node, pos: pos}]\n\t\tsetPositions(positions => newpositions)\n\t\tsetLinks(organizeLinks(newpositions, data.links))\n\t}\n\n\treturn <svg style={style} onClick={handleClick}>\n\t\t\t{links.filter(item => item.a && item.b).map(item => <Link a={item.a} b={item.b} />)}\n\t\t\t{positions.map(item =>\n\t\t\t\tsize.width && size.height && <Node\n\t\t\t\t\tkey={item.id}\n\t\t\t\t\tid={item.id}\n\t\t\t\t\tlabel={item.name}\n\t\t\t\t\ttype={item.type}\n\t\t\t\t\tpos={item.pos}\n\t\t\t\t\tr = {20}\n\t\t\t\t\tonDragging = {handleDragging}\n\t\t\t\t/>)}\n\t\t</svg>\n}\n\nexport default Network\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}