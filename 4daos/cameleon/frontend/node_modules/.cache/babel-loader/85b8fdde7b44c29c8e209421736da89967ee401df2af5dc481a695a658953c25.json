{"ast":null,"code":"import _regeneratorRuntime from\"/home/samuel/dev/4daos/cameleon/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/samuel/dev/4daos/cameleon/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/home/samuel/dev/4daos/cameleon/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/samuel/dev/4daos/cameleon/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/home/samuel/dev/4daos/cameleon/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/samuel/dev/4daos/cameleon/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import Session from'./session';import Rest from'./rest';import Interpreter from'./interpreter';import objects from'./context';import language from'./language';var Model=/*#__PURE__*/function(_Session){_inherits(Model,_Session);var _super=_createSuper(Model);function Model(initialized){var _this;_classCallCheck(this,Model);_this=_super.call(this);_this.state={system:{},user:{}};_this.initialize(initialized);return _this;}_createClass(Model,[{key:\"initialize\",value:function(){var _initialize=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(initialized){var config;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:this.rest=new Rest();_context.next=3;return this.loadConfig();case 3:config=_context.sent;this.state.ok=config.ok;if(this.state.ok){this.state.system.region=config.data.region;this.state.system.copyright=config.data.copyright;this.state.user.apps=config.data.apps;this.interpreter=new Interpreter(language,objects);this.connect();}initialized(this);case 7:case\"end\":return _context.stop();}},_callee,this);}));function initialize(_x){return _initialize.apply(this,arguments);}return initialize;}()},{key:\"onLatency\",value:function onLatency(data){//this.onUpdate && this.onUpdate(data.time, 'latency')\n}},{key:\"loadConfig\",value:function(){var _loadConfig=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return this.rest.config();case 2:return _context2.abrupt(\"return\",_context2.sent);case 3:case\"end\":return _context2.stop();}},_callee2,this);}));function loadConfig(){return _loadConfig.apply(this,arguments);}return loadConfig;}()},{key:\"update\",value:function update(id,data){var command=this.interpreter.build(data);console.log(command);}}]);return Model;}(Session);export default Model;","map":{"version":3,"names":["Session","Rest","Interpreter","objects","language","Model","_Session","_inherits","_super","_createSuper","initialized","_this","_classCallCheck","call","state","system","user","initialize","_createClass","key","value","_initialize","_asyncToGenerator","_regeneratorRuntime","mark","_callee","config","wrap","_callee$","_context","prev","next","rest","loadConfig","sent","ok","region","data","copyright","apps","interpreter","connect","stop","_x","apply","arguments","onLatency","_loadConfig","_callee2","_callee2$","_context2","abrupt","update","id","command","build","console","log"],"sources":["/home/samuel/dev/4daos/cameleon/frontend/src/model/index.js"],"sourcesContent":["import Session from './session'\nimport Rest from './rest'\nimport Interpreter from './interpreter'\nimport objects from './context'\nimport language from './language'\n\nclass Model extends Session{\n\tconstructor( initialized ){\n\t\tsuper()\n\n\t\tthis.state = {\n\t\t\tsystem: {},\n\t\t\tuser: {}\n\t\t}\n\t\tthis.initialize( initialized )\n\t}\n\n\tasync initialize( initialized ){\n\t\tthis.rest = new Rest()\n\t\tlet config = await this.loadConfig()\n\n\t\tthis.state.ok = config.ok\n\n\t\tif (this.state.ok){\n\t\t\tthis.state.system.region = config.data.region\n\t\t\tthis.state.system.copyright = config.data.copyright\n\n\t\t\tthis.state.user.apps = config.data.apps\n\n\t\t\tthis.interpreter = new Interpreter(language, objects)\n\n\t\t\tthis.connect()\n\t\t}\n\n\t\tinitialized( this )\n\t}\n\n\tonLatency(data) {\n\t\t//this.onUpdate && this.onUpdate(data.time, 'latency')\n\t}\n\n\tasync loadConfig(){\n\t\treturn await this.rest.config()\n\t}\n\n\tupdate(id, data){\n\t\tlet command = this.interpreter.build(data)\n\n\t\tconsole.log(command)\n\t}\n}\n\nexport default Model\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}