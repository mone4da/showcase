{"ast":null,"code":"import _toConsumableArray from\"/home/samuel/dev/4daos/cameleon/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/samuel/dev/4daos/cameleon/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState}from'react';import Cli from'./cli';import Window from'./window';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var availableTypes=['window','cli'];var defaultPosition={x:200,y:200};var renderApp=function renderApp(name,Component,event,asset,offset,onFocused,onDragged,onClose,onCommand){switch(name){case'cli':return/*#__PURE__*/_jsx(Cli,{Component:Component,event:event,asset:asset.cli,offset:offset,onFocused:onFocused,onDragged:onDragged,onClose:onClose,onCommand:onCommand});case'window':return/*#__PURE__*/_jsx(Window,{Component:Component,event:event,asset:asset.cli,offset:offset,onFocused:onFocused,onDragged:onDragged,onClose:onClose});}return null;};var AppManager=function AppManager(props){var types=props.types,Component=props.Component,state=props.state,asset=props.asset,style=props.style,onUpdate=props.onUpdate,event=props.event,onFocused=props.onFocused,onClose=props.onClose,onCommand=props.onCommand;var _useState=useState(Object.fromEntries(availableTypes.map(function(type){return[type,defaultPosition];}))),_useState2=_slicedToArray(_useState,2),positions=_useState2[0],setPositions=_useState2[1];var _useState3=useState(types),_useState4=_slicedToArray(_useState3,2),instances=_useState4[0],setInstances=_useState4[1];var handleFocused=function handleFocused(id,offset){onFocused&&onFocused(id,offset);};var handleDragged=function handleDragged(id,offset){setPositions(function(positions){positions[id]=offset;return positions;});};var handleClose=function handleClose(id){setPositions(function(positions){positions[id]=defaultPosition;return positions;});onClose&&onClose(id);};var handleCommand=function handleCommand(data){onCommand&&onCommand(data);};if(event.source==='command-desktop'){console.log('window added');setInstances(function(instances){return[].concat(_toConsumableArray(instances),['window']);});}return/*#__PURE__*/_jsx(_Fragment,{children:instances.map(function(id){return renderApp(id,Component,event,asset,positions[id],function(){return handleFocused(id);},function(offset){return handleDragged(id,offset);},function(){return handleClose(id);},function(data){return handleCommand(data);});})});};export default AppManager;","map":{"version":3,"names":["useState","Cli","Window","jsx","_jsx","Fragment","_Fragment","availableTypes","defaultPosition","x","y","renderApp","name","Component","event","asset","offset","onFocused","onDragged","onClose","onCommand","cli","AppManager","props","types","state","style","onUpdate","_useState","Object","fromEntries","map","type","_useState2","_slicedToArray","positions","setPositions","_useState3","_useState4","instances","setInstances","handleFocused","id","handleDragged","handleClose","handleCommand","data","source","console","log","concat","_toConsumableArray","children"],"sources":["/home/samuel/dev/4daos/cameleon/frontend/src/view/appmanager.js"],"sourcesContent":["import {useState} from 'react'\nimport Cli from './cli'\nimport Window from './window'\n\nconst availableTypes = ['window','cli']\n\nconst defaultPosition = {x: 200, y: 200}\n\nlet renderApp = (name, Component, event, asset, offset, onFocused, onDragged, onClose, onCommand) => {\n\tswitch(name){\n\t\tcase 'cli' : return <Cli Component={Component} event={event} asset = {asset.cli}  offset={offset}  onFocused={onFocused} onDragged={onDragged} onClose={onClose} onCommand={onCommand}/>\n\t\tcase 'window' : return <Window Component={Component} event={event} asset = {asset.cli}  offset={offset}  onFocused={onFocused} onDragged={onDragged} onClose={onClose} />\n\t}\n\n\treturn null\n}\n\nlet AppManager = props => {\n\tlet {\n\t\ttypes,\n\t\tComponent,\n\t\tstate,\n\t\tasset,\n\t\tstyle,\n\t\tonUpdate,\n\t\tevent,\n\t\tonFocused,\n\t\tonClose,\n\t\tonCommand} = props\n\n\tlet [positions, setPositions] = useState( Object.fromEntries( availableTypes.map(type => [type, defaultPosition]) ) )\n\n\tlet [instances, setInstances] = useState( types )\n\n\n\tlet handleFocused = (id, offset) => {\n\t\tonFocused && onFocused(id, offset)\n\t}\n\n\tlet handleDragged = (id, offset) => {\n\t\tsetPositions( positions => {\n\t\t\tpositions[id] = offset\n\t\t\treturn positions\n\t\t})\n\t}\n\n\tlet handleClose = id => {\n\n\t\tsetPositions( positions => {\n\t\t\tpositions[id] = defaultPosition\n\t\t\treturn positions\n\t\t})\n\n\t\tonClose && onClose(id)\n\t}\n\n\tlet handleCommand = data => {\n\t\tonCommand && onCommand(data)\n\t}\n\n\tif (event.source === 'command-desktop'){\n\t\tconsole.log('window added')\n\t\tsetInstances(instances => [...instances, 'window'])\n\t}\n\n\treturn <>{instances.map(id => renderApp(\n\t\t\t\t\tid,\n\t\t\t\t\tComponent,\n\t\t\t\t\tevent,\n\t\t\t\t\tasset,\n\t\t\t\t\tpositions[id],\n\t\t\t\t\t() => handleFocused(id),\n\t\t\t\t\toffset => handleDragged(id, offset),\n\t\t\t\t\t() => handleClose(id),\n\t\t\t\t\tdata => handleCommand(data)\n\t\t\t\t)\n\t\t\t)}</>\n\n}\n\nexport default  AppManager\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}